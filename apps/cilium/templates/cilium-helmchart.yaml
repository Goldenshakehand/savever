apiVersion: helm.cattle.io/v1
kind: HelmChart
metadata:
  name: cilium
  namespace: kube-system
spec:
  repo: https://helm.cilium.io/
  chart: cilium
  version: "1.18.0"
  targetNamespace: kube-system
  valuesContent: |
    kubeProxyReplacement: "disabled"
    routingMode: "tunnel"
    tunnel: "vxlan"

    ipv4:
      enabled: true
    ipv6:
      enabled: false

    ipam:
      mode: cluster-pool
      operator:
        clusterPoolIPv4PodCIDRList:
          - "10.42.0.0/16"
        clusterPoolIPv4MaskSize: 24

    enableIPv4Masquerade: true

    operator:
      replicas: 1

    hubble:
      enabled: true
      metrics:
        enableOpenMetrics: true
        enabled:
          - dns
          - drop
          - tcp
          - flow
          - port-distribution
          - icmp
          - http
      relay:
        enabled: true
      ui:
        enabled: true
